This is a documentation for the multiple json files that are needed to run Azure VM deployment using
Azure Templates. This includes launching a base VM, then launching Custom Script Extensions that allow us to run
some Linux shell (.sh) scripts to install R and RStudio.

Launching a VM:
To start, we will launch a VM using the template.
The file VMtemplate.json contains a template to launch a VM. The file VMtemplate.parameters.json includes the parameters
we are using with that VM launch. Using the Azure CLI, (elaborate) the command "az deployment group create --resource-group rg --template-file VMtemplate.json --parameters VMtemplate.parameters.json"
can be used to launch the VM within the provided resource group.

Once the deployment is complete, navigate to the Azure Portal to ensure your VM has been provisioned.

Launching Script Extensions:
In its simplest form, a script can be run on a VM as long as the shell script resides within a storage account on the Azure Portal
The extensionscript.json includes the minimum fields needed to run a script this way. 




NOTE THAT THE STORAGE ACCOUNT KEY WILL HAVE TO BE ADDED INTO THE EXTENSIONSCRIPTS JSONS, THEY ARE TAKEN OUT FOR GITLAB UPLOAD

THE STORAGE ACCOUNT USED IN THE JSONS IS THE STORAGE ACCOUNT WHERE THE SHELL SCRIPTS HAVE BEEN UPLOADED TO.

TEST 1: Use azrunr_script.sh and extensionscript.json then open ports 80, 443, and 8787.
command run: az vm extension set --resource-group scriptvmcreation --vm-name scriptvm --name customScript --publisher Microsoft.Azure.Extensions --protected-settings ./extensionscript.json
results in the extension deploying successfully, but the VM is unable to connect to RStudio

TEST 2: use azrunr_script2.sh and extensionscript2.json then opening ports 80, 443, and 8787 then running azrunr_script3.sh and extensionscript3.json. This follows
the procedure found within the following link: https://techcommunity.microsoft.com/t5/educator-developer-blog/hosting-rserver-and-rstudio-on-azure/ba-p/744389


az vm extension set --resource-group scriptvmcreation --vm-name scriptvm --name customScript --publisher Microsoft.Azure.Extensions --protected-settings ./extensionscript2.json

results in:

Deployment failed. Correlation ID: ad4f47ff-962c-4536-886e-950e72bc7dc6. VM has reported a failure when processing extension 'customScript'. Error message: "Enable failed: failed to execute command: command terminated with exit status=1
[stdout]
ibalgorithm-merge-perl libarchive-cpio-perl libarchive-zip-perl libasan4
  libatomic1 libauthen-sasl-perl libbinutils libblas-dev libblas3 libbz2-dev
  libc-dev-bin libc6-dev libcairo2 libcc1-0 libcilkrts5 libcroco3
  libdata-dump-perl libdatrie1 libdpkg-perl libdrm-amdgpu1 libdrm-intel1
  libdrm-nouveau2 libdrm-radeon1 libencode-locale-perl libfakeroot
  libfile-basedir-perl libfile-desktopentry-perl libfile-fcntllock-perl
  libfile-listing-perl libfile-mimeinfo-perl libfile-stripnondeterminism-perl
  libfile-which-perl libfont-afm-perl libfontconfig1 libfontenc1 libgcc-7-dev
  libgfortran-7-dev libgfortran4 libgl1 libgl1-mesa-dri libgl1-mesa-glx
  libglapi-mesa libglib2.0-bin libglib2.0-dev libglib2.0-dev-bin libglvnd0
  libglx-mesa0 libglx0 libgomp1 libgraphite2-3 libgraphite2-dev
  libharfbuzz-dev libharfbuzz-gobject0 libharfbuzz-icu0 libharfbuzz0b
  libhtml-form-perl libhtml-format-perl libhtml-parser-perl
  libhtml-tagset-perl libhtml-tree-perl libhttp-cookies-perl
  libhttp-daemon-perl libhttp-date-perl libhttp-message-perl
  libhttp-negotiate-perl libice6 libicu-dev libicu-le-hb-dev libicu-le-hb0
  libiculx60 libio-html-perl libio-socket-ssl-perl libipc-system-simple-perl
  libisl19 libitm1 libjbig0 libjpeg-dev libjpeg-turbo8 libjpeg-turbo8-dev
  libjpeg8 libjpeg8-dev libjq1 liblapack-dev liblapack3 libllvm10 liblsan0
  libltdl-dev libltdl7 liblwp-mediatypes-perl liblwp-protocol-https-perl
  liblzma-dev libmail-sendmail-perl libmailtools-perl libmpc3 libmpx2
  libncurses5-dev libnet-dbus-perl libnet-http-perl libnet-smtp-ssl-perl
  libnet-ssleay-perl libonig4 libpango-1.0-0 libpangocairo-1.0-0
  libpangoft2-1.0-0 libpaper-utils libpaper1 libpciaccess0 libpcre16-3
  libpcre3-dev libpcre32-3 libpcrecpp0v5 libpixman-1-0 libpng-dev libpng-tools
  libquadmath0 libreadline-dev libsensors4 libsm6 libstdc++-7-dev
  libsys-hostname-long-perl libtcl8.6 libthai-data libthai0 libtie-ixhash-perl
  libtiff5 libtimedate-perl libtinfo-dev libtk8.6 libtool libtry-tiny-perl
  libtsan0 libubsan0 liburi-perl libwww-perl libwww-robotrules-perl
  libx11-protocol-perl libx11-xcb1 libxaw7 libxcb-dri2-0 libxcb-dri3-0
  libxcb-glx0 libxcb-present0 libxcb-render0 libxcb-shape0 libxcb-shm0
  libxcb-sync1 libxcomposite1 libxcursor1 libxdamage1 libxfixes3 libxft2
  libxi6 libxinerama1 libxml-parser-perl libxml-twig-perl
  libxml-xpathengine-perl libxmu6 libxpm4 libxrandr2 libxrender1 libxshmfence1
  libxss1 libxt6 libxtst6 libxv1 libxxf86dga1 libxxf86vm1 linux-libc-dev m4
  make manpages-dev perl-openssl-defaults pkg-config po-debconf
  python3-distutils python3-lib2to3 python3-scour r-base r-base-core
  r-base-dev r-base-html r-cran-boot r-cran-class r-cran-cluster
  r-cran-codetools r-cran-foreign r-cran-kernsmooth r-cran-lattice r-cran-mass
  r-cran-matrix r-cran-mgcv r-cran-nlme r-cran-nnet r-cran-rpart
  r-cran-spatial r-cran-survival r-doc-html r-recommended scour unzip
  x11-common x11-utils x11-xserver-utils xdg-utils zip zlib1g-dev
0 upgraded, 242 newly installed, 0 to remove and 19 not upgraded.
Need to get 151 MB of archives.
After this operation, 721 MB of additional disk space will be used.
Do you want to continue? [Y/n] Abort.
Reading package lists...
Building dependency tree...
Reading state information...
The following packages were automatically installed and are no longer required:
  grub-pc-bin linux-headers-4.15.0-112
Use 'sudo apt autoremove' to remove them.
The following additional packages will be installed:
  apache2-bin apache2-data apache2-utils libapr1 libaprutil1
  libaprutil1-dbd-sqlite3 libaprutil1-ldap liblua5.2-0 ssl-cert
Suggested packages:
  www-browser apache2-doc apache2-suexec-pristine | apache2-suexec-custom
  openssl-blacklist
The following NEW packages will be installed:
  apache2 apache2-bin apache2-data apache2-utils libapr1 libaprutil1
  libaprutil1-dbd-sqlite3 libaprutil1-ldap liblua5.2-0 ssl-cert
0 upgraded, 10 newly installed, 0 to remove and 19 not upgraded.
Need to get 1729 kB of archives.
After this operation, 6985 kB of additional disk space will be used.
Do you want to continue? [Y/n] Abort.

[stderr]

WARNING: apt does not have a stable CLI interface. Use with caution in scripts.

"

More information on troubleshooting is available at https://aka.ms/vmextensionlinuxtroubleshoot 